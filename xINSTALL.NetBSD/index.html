



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="MISP Project - Install Guides">
      
      
        <link rel="canonical" href="https://www.misp-project.org/xINSTALL.NetBSD/">
      
      
        <meta name="author" content="MISP Project">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>INSTALLATION INSTRUCTIONS - MISP Install Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#installation-instructions" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.misp-project.org/" title="MISP Install Documentation" class="md-header-nav__button md-logo">
          
            <img src="../img/misp.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              MISP Install Documentation
            </span>
            <span class="md-header-nav__topic">
              INSTALLATION INSTRUCTIONS
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/MISP/MISP" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    MISP/MISP
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.misp-project.org/" title="MISP Install Documentation" class="md-nav__button md-logo">
      
        <img src="../img/misp.png" width="48" height="48">
      
    </a>
    MISP Install Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/MISP/MISP" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    MISP/MISP
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Install Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Install Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.ubuntu1804/" title="Ubuntu 18.04" class="md-nav__link">
      Ubuntu 18.04
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.kali/" title="Kali Linux" class="md-nav__link">
      Kali Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.rhel7/" title="RHEL7/CentOS7" class="md-nav__link">
      RHEL7/CentOS7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.rhel8/" title="RHEL8" class="md-nav__link">
      RHEL8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      xInstall Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        xInstall Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL/" title="Warning" class="md-nav__link">
      Warning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.centos6/" title="Centos 6" class="md-nav__link">
      Centos 6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.debian10/" title="Debian 10" class="md-nav__link">
      Debian 10
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.debian9/" title="Debian 9.9" class="md-nav__link">
      Debian 9.9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.ubuntu1804.with.webmin/" title="Ubuntu 18.04 \w webmin" class="md-nav__link">
      Ubuntu 18.04 \w webmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.tsurugi/" title="Tsurugi Linux" class="md-nav__link">
      Tsurugi Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.OpenBSD/" title="OpenBSD 6.5" class="md-nav__link">
      OpenBSD 6.5
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Config Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Config Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.elasticsearch-logging/" title="Elastic Search Logging" class="md-nav__link">
      Elastic Search Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.s3-attachments/" title="Amazon S3 attachments" class="md-nav__link">
      Amazon S3 attachments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.SMIME/" title="S/MIME" class="md-nav__link">
      S/MIME
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../UPDATE/" title="Update MISP" class="md-nav__link">
      Update MISP
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../UPGRADE/" title="Upgrading MISP" class="md-nav__link">
      Upgrading MISP
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Old guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Old guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../archive/old-2_3to2_4-UPGRADE/" title="2.3 to 2.4 upgrade" class="md-nav__link">
      2.3 to 2.4 upgrade
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../archive/INSTALL.ubuntu1604/" title="Ubuntu 16.04" class="md-nav__link">
      Ubuntu 16.04
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../archive/xINSTALL.FreeBSD/" title="FreeBSD" class="md-nav__link">
      FreeBSD
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Changelog/" title="MISP Release Notes" class="md-nav__link">
      MISP Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-netbsd-81-amd64" title="for NetBSD 8.1-amd64" class="md-nav__link">
    for NetBSD 8.1-amd64
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-wip-you-are-warned-this-does-only-partially-work" title="0/ WIP! You are warned, this does only partially work!" class="md-nav__link">
    0/ WIP! You are warned, this does only partially work!
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misp-configuration-variables" title="MISP configuration variables" class="md-nav__link">
    MISP configuration variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-minimal-openbsd-install" title="1/ Minimal OpenBSD install" class="md-nav__link">
    1/ Minimal OpenBSD install
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-standard-netbsd-amd64-without-x11" title="Install standard NetBSD-amd64 without X11" class="md-nav__link">
    Install standard NetBSD-amd64 without X11
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-hardening" title="System Hardening" class="md-nav__link">
    System Hardening
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sudo-pkgin-as-root" title="sudo &amp; pkgin (as root)" class="md-nav__link">
    sudo &amp; pkgin (as root)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-case-you-forgot-to-fetch-pkgsrc-optional" title="In case you forgot to fetch pkgsrc (optional)" class="md-nav__link">
    In case you forgot to fetch pkgsrc (optional)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-bash" title="Install bash" class="md-nav__link">
    Install bash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mariadb-server" title="mariadb server" class="md-nav__link">
    mariadb server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-misc-dependencies" title="Install misc dependencies" class="md-nav__link">
    Install misc dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-postfix-optional" title="Install postfix (optional)" class="md-nav__link">
    Install postfix (optional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vim-optional" title="vim (optional)" class="md-nav__link">
    vim (optional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misp-user-remove" title="misp user #REMOVE" class="md-nav__link">
    misp user #REMOVE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-php-moz-rootcerts" title="apache + php + moz-rootcerts" class="md-nav__link">
    apache + php + moz-rootcerts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-x11r7-post-install" title="Install X11R7 post-install" class="md-nav__link">
    Install X11R7 post-install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-a-valid-ssl-certificate-is-not-already-created-for-the-server-create-a-self-signed-certificate" title="If a valid SSL certificate is not already created for the server, create a self-signed certificate:" class="md-nav__link">
    If a valid SSL certificate is not already created for the server, create a self-signed certificate:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-python-virtualenv" title="Install Python virtualenv" class="md-nav__link">
    Install Python virtualenv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-ssdeep" title="Install ssdeep" class="md-nav__link">
    Install ssdeep
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usrpkgetcphpini" title="/usr/pkg/etc/php.ini" class="md-nav__link">
    /usr/pkg/etc/php.ini
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-redis" title="Enable redis" class="md-nav__link">
    Enable redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-mysqld" title="Enable mysqld" class="md-nav__link">
    Enable mysqld
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-misp-code" title="2/ MISP code" class="md-nav__link">
    2/ MISP code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-cakephp" title="3/ CakePHP" class="md-nav__link">
    3/ CakePHP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-the-permissions" title="4/ Set the permissions" class="md-nav__link">
    4/ Set the permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-create-a-database-and-user" title="5/ Create a database and user" class="md-nav__link">
    5/ Create a database and user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-apache-configuration" title="6/ Apache configuration" class="md-nav__link">
    6/ Apache configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-misp-configuration" title="8/ MISP configuration" class="md-nav__link">
    8/ MISP configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-actions" title="Recommended actions" class="md-nav__link">
    Recommended actions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misp-modules" title="MISP Modules" class="md-nav__link">
    MISP Modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misp-config-automation" title="MISP Config Automation" class="md-nav__link">
    MISP Config Automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-actions_1" title="Recommended actions" class="md-nav__link">
    Recommended actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-features" title="Optional features" class="md-nav__link">
    Optional features
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zeromq-depends-on-the-python-client-for-redis" title="ZeroMQ depends on the Python client for Redis" class="md-nav__link">
    ZeroMQ depends on the Python client for Redis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misp-dashboard" title="misp-dashboard" class="md-nav__link">
    misp-dashboard
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="installation-instructions">INSTALLATION INSTRUCTIONS<a class="headerlink" href="#installation-instructions" title="Permanent link">&para;</a></h1>
<h2 id="for-netbsd-81-amd64">for NetBSD 8.1-amd64<a class="headerlink" href="#for-netbsd-81-amd64" title="Permanent link">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not fully working yet. Mostly it is a template for our ongoing documentation efforts <img alt="ðŸ•·" class="emojione" src="https://cdn.jsdelivr.net/emojione/assets/svg/1f577.svg" title=":spider:" />
LIEF, will probably not be available for a long long time on NetBSD, until someone is brave enough to make it work.
GnuPG also needs some more TLC.
misp-modules are broken because of the python-opencv dependency.</p>
</div>
<h3 id="0-wip-you-are-warned-this-does-only-partially-work">0/ WIP! You are warned, this does only partially work!<a class="headerlink" href="#0-wip-you-are-warned-this-does-only-partially-work" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="misp-configuration-variables">MISP configuration variables<a class="headerlink" href="#misp-configuration-variables" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c1"># &lt;snippet-begin 0_global-vars.sh&gt;</span>
<span class="c1"># $ eval &quot;$(curl -fsSL https://raw.githubusercontent.com/MISP/MISP/2.4/docs/generic/globalVariables.md | grep -v \`\`\`)&quot;</span>
<span class="c1"># $ MISPvars</span>
MISPvars <span class="o">()</span> <span class="o">{</span>
  debug <span class="s2">&quot;Setting generic </span><span class="si">${</span><span class="nv">LBLUE</span><span class="si">}</span><span class="s2">MISP</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2"> variables shared by all flavours&quot;</span> <span class="m">2</span>&gt; /dev/null
  <span class="c1"># Local non-root MISP user</span>
  <span class="nv">MISP_USER</span><span class="o">=</span><span class="s1">&#39;misp&#39;</span>
  <span class="nv">MISP_PASSWORD</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>

  <span class="c1"># MISP configuration variables</span>
  <span class="nv">PATH_TO_MISP</span><span class="o">=</span><span class="s1">&#39;/var/www/MISP&#39;</span>

  <span class="c1"># The web server user</span>
  <span class="c1"># RHEL/CentOS</span>
  <span class="k">if</span> <span class="o">[[</span> -f <span class="s2">&quot;/etc/redhat-release&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">WWW_USER</span><span class="o">=</span><span class="s1">&#39;apache&#39;</span>
  <span class="c1"># Debian flavoured</span>
  <span class="k">elif</span> <span class="o">[[</span> -f <span class="s2">&quot;/etc/debian_version&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">WWW_USER</span><span class="o">=</span><span class="s2">&quot;www-data&quot;</span>
  <span class="c1"># OpenBSD</span>
  <span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="k">$(</span>uname -s<span class="k">)</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;OpenBSD&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">WWW_USER</span><span class="o">=</span><span class="s2">&quot;www&quot;</span>
    <span class="nv">PATH_TO_MISP</span><span class="o">=</span><span class="s2">&quot;/var/www/htdocs/MISP&quot;</span>
  <span class="c1"># NetBSD</span>
  <span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="k">$(</span>uname -s<span class="k">)</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;NetBSD&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">WWW_USER</span><span class="o">=</span><span class="s2">&quot;www&quot;</span>
    <span class="nv">PATH_TO_MISP</span><span class="o">=</span><span class="s2">&quot;/usr/pkg/share/httpd/htdocs/MISP&quot;</span>
  <span class="k">else</span>
    <span class="c1"># I am feeling lucky</span>
    <span class="nv">WWW_USER</span><span class="o">=</span><span class="s2">&quot;www-data&quot;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$FQDN</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">FQDN</span><span class="o">=</span><span class="s2">&quot;misp.local&quot;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$MISP_BASEURL</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">MISP_BASEURL</span><span class="o">=</span><span class="s1">&#39;&quot;&quot;&#39;</span>
  <span class="k">fi</span>

  <span class="nv">MISP_LIVE</span><span class="o">=</span><span class="s1">&#39;1&#39;</span>

  <span class="c1"># Database configuration</span>
  <span class="nv">DBHOST</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
  <span class="nv">DBNAME</span><span class="o">=</span><span class="s1">&#39;misp&#39;</span>
  <span class="nv">DBUSER_ADMIN</span><span class="o">=</span><span class="s1">&#39;root&#39;</span>
  <span class="nv">DBPASSWORD_ADMIN</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>
  <span class="nv">DBUSER_MISP</span><span class="o">=</span><span class="s1">&#39;misp&#39;</span>
  <span class="nv">DBPASSWORD_MISP</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>

  <span class="c1"># OpenSSL configuration</span>
  <span class="nv">OPENSSL_CN</span><span class="o">=</span><span class="nv">$FQDN</span>
  <span class="nv">OPENSSL_C</span><span class="o">=</span><span class="s1">&#39;LU&#39;</span>
  <span class="nv">OPENSSL_ST</span><span class="o">=</span><span class="s1">&#39;State&#39;</span>
  <span class="nv">OPENSSL_L</span><span class="o">=</span><span class="s1">&#39;Location&#39;</span>
  <span class="nv">OPENSSL_O</span><span class="o">=</span><span class="s1">&#39;Organization&#39;</span>
  <span class="nv">OPENSSL_OU</span><span class="o">=</span><span class="s1">&#39;Organizational Unit&#39;</span>
  <span class="nv">OPENSSL_EMAILADDRESS</span><span class="o">=</span><span class="s2">&quot;info@</span><span class="nv">$FQDN</span><span class="s2">&quot;</span>

  <span class="c1"># GPG configuration</span>
  <span class="nv">GPG_REAL_NAME</span><span class="o">=</span><span class="s1">&#39;Autogenerated Key&#39;</span>
  <span class="c1"># On a REAL install, please do not set a comment, see here for why: https://www.debian-administration.org/users/dkg/weblog/97</span>
  <span class="nv">GPG_COMMENT</span><span class="o">=</span><span class="s1">&#39;WARNING: MISP AutoGenerated Key consider this Key VOID!&#39;</span>
  <span class="nv">GPG_EMAIL_ADDRESS</span><span class="o">=</span><span class="s1">&#39;admin@admin.test&#39;</span>
  <span class="c1"># 3072 bits used as per suggestions here: https://riseup.net/en/security/message-security/openpgp/best-practices</span>
  <span class="nv">GPG_KEY_LENGTH</span><span class="o">=</span><span class="s1">&#39;3072&#39;</span>
  <span class="nv">GPG_PASSPHRASE</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>

  <span class="c1"># debug alias to make sure people are not confused when blindly copy pasting blobs of code</span>
  <span class="nb">alias</span> <span class="nv">debug</span><span class="o">=</span><span class="s2">&quot;echo -e&quot;</span>

  <span class="c1"># checkAptLock alias to make sure people are not confused when blindly copy pasting blobs of code</span>
  <span class="nb">alias</span> <span class="nv">checkAptLock</span><span class="o">=</span><span class="s2">&quot;echo &#39;Function used in Installer to make sure apt is not locked&#39;&quot;</span>

  <span class="c1"># php.ini configuration</span>
  <span class="nv">upload_max_filesize</span><span class="o">=</span>50M
  <span class="nv">post_max_size</span><span class="o">=</span>50M
  <span class="nv">max_execution_time</span><span class="o">=</span><span class="m">300</span>
  <span class="nv">memory_limit</span><span class="o">=</span>512M

  <span class="nv">CAKE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH_TO_MISP</span><span class="s2">/app/Console/cake&quot;</span>

  <span class="c1"># sudo config to run $LUSER commands</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="k">$(</span>groups <span class="si">${</span><span class="nv">MISP_USER</span><span class="si">}</span> <span class="p">|</span>grep -o <span class="s1">&#39;staff&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;staff&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">SUDO_USER</span><span class="o">=</span><span class="s2">&quot;sudo -H -u </span><span class="si">${</span><span class="nv">MISP_USER</span><span class="si">}</span><span class="s2"> -g staff&quot;</span>
  <span class="k">else</span>
    <span class="nv">SUDO_USER</span><span class="o">=</span><span class="s2">&quot;sudo -H -u </span><span class="si">${</span><span class="nv">MISP_USER</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">fi</span>
  <span class="nv">SUDO_WWW</span><span class="o">=</span><span class="s2">&quot;sudo -H -u </span><span class="si">${</span><span class="nv">WWW_USER</span><span class="si">}</span><span class="s2"> &quot;</span>

  <span class="nb">echo</span> <span class="s2">&quot;The following DB Passwords were generated...&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Admin (</span><span class="si">${</span><span class="nv">DBUSER_ADMIN</span><span class="si">}</span><span class="s2">) DB Password: </span><span class="si">${</span><span class="nv">DBPASSWORD_ADMIN</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;User  (</span><span class="si">${</span><span class="nv">DBUSER_MISP</span><span class="si">}</span><span class="s2">) DB Password: </span><span class="si">${</span><span class="nv">DBPASSWORD_MISP</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>
<span class="c1"># &lt;snippet-end 0_global-vars.sh&gt;</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="nb">export</span> <span class="nv">AUTOMAKE_VERSION</span><span class="o">=</span><span class="m">1</span>.16
<span class="nb">export</span> <span class="nv">AUTOCONF_VERSION</span><span class="o">=</span><span class="m">2</span>.69
</pre></div>

<h3 id="1-minimal-openbsd-install">1/ Minimal OpenBSD install<a class="headerlink" href="#1-minimal-openbsd-install" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="install-standard-netbsd-amd64-without-x11">Install standard NetBSD-amd64 without X11<a class="headerlink" href="#install-standard-netbsd-amd64-without-x11" title="Permanent link">&para;</a></h4>
<ul>
<li>ntpdate on boot</li>
<li>ntp</li>
<li>ntpd</li>
<li>ssh</li>
</ul>
<h4 id="system-hardening">System Hardening<a class="headerlink" href="#system-hardening" title="Permanent link">&para;</a></h4>
<ul>
<li>TBD</li>
</ul>
<h4 id="sudo-pkgin-as-root">sudo &amp; pkgin (as root)<a class="headerlink" href="#sudo-pkgin-as-root" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>su root -c <span class="s2">&quot;pkgin install sudo gsed&quot;</span>
su root -c <span class="s1">&#39;gsed -i -e &quot;s/# %wheel ALL=(ALL) NOPASSWD: ALL/%wheel ALL=(ALL) NOPASSWD: ALL/&quot; /usr/pkg/etc/sudoers&#39;</span>
</pre></div>

<h5 id="in-case-you-forgot-to-fetch-pkgsrc-optional">In case you forgot to fetch pkgsrc (optional)<a class="headerlink" href="#in-case-you-forgot-to-fetch-pkgsrc-optional" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /usr
env <span class="nv">CVS_RSH</span><span class="o">=</span>ssh sudo cvs -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc
<span class="nb">cd</span> pkgsrc/bootstrap
sudo ./bootstrap
sudo /usr/pkg/sbin/pkg_admin -K /var/db/pkg fetch-pkg-vulnerabilities
</pre></div>

<div class="codehilite"><pre><span></span>You may wish to have the vulnerabilities file downloaded daily so that it
remains current. This may be done by adding an appropriate entry to the root
users crontab(5) entry. For example the entry

# Download vulnerabilities file
0 3 * * * /usr/pkg/sbin/pkg_admin fetch-pkg-vulnerabilities &gt;/dev/null 2&gt;&amp;1
# Audit the installed packages and email results to root
9 3 * * * /usr/pkg/sbin/pkg_admin audit |mail -s &quot;Installed package audit result&quot; \
            root &gt;/dev/null 2&gt;&amp;1
</pre></div>

<h4 id="install-bash">Install bash<a class="headerlink" href="#install-bash" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install bash
</pre></div>

<h4 id="mariadb-server">mariadb server<a class="headerlink" href="#mariadb-server" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install mariadb-server 
</pre></div>

<h4 id="install-misc-dependencies">Install misc dependencies<a class="headerlink" href="#install-misc-dependencies" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install curl git python36 py36-pip redis autoconf automake libtool magic
</pre></div>

<div class="codehilite"><pre><span></span>sudo pkgin install gnupg2
</pre></div>

<h4 id="install-postfix-optional">Install postfix (optional)<a class="headerlink" href="#install-postfix-optional" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install postfix
</pre></div>

<h4 id="vim-optional">vim (optional)<a class="headerlink" href="#vim-optional" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install vim
sudo mv /usr/bin/vi /usr/bin/vi-<span class="sb">`</span>date +%d%m%y<span class="sb">`</span>
sudo ln -s /usr/pkg/bin/vim /usr/bin/vi
</pre></div>

<h4 id="misp-user-remove">misp user #REMOVE<a class="headerlink" href="#misp-user-remove" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo useradd -m -s /usr/local/bin/bash -G wheel,www misp
</pre></div>

<h4 id="apache-php-moz-rootcerts">apache + php + moz-rootcerts<a class="headerlink" href="#apache-php-moz-rootcerts" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install php ap24-php73 php73-fpm php73-redis3 php73-mysqli php73-pdo_mysql php73-pcntl php73-json php73-iconv php73-gd php73-mbstring php73-pear-Crypt_GPG
sudo cp /usr/share/examples/openssl/openssl.cnf /etc/openssl/
sudo mozilla-rootcerts install
sudo cp /usr/pkg/share/examples/rc.d/apache /etc/rc.d/
<span class="nb">echo</span> <span class="nv">apache</span><span class="o">=</span>yes <span class="p">|</span>sudo tee /etc/rc.conf.d/apache
</pre></div>

<h4 id="install-x11r7-post-install">Install X11R7 post-install<a class="headerlink" href="#install-x11r7-post-install" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /tmp
wget https://ftp.netbsd.org/pub/NetBSD/NetBSD-8.1/amd64/binary/sets/xbase.tgz
sudo tar -C / -xzphf xbase.tgz
rm xbase.tgz
</pre></div>

<h4 id="if-a-valid-ssl-certificate-is-not-already-created-for-the-server-create-a-self-signed-certificate">If a valid SSL certificate is not already created for the server, create a self-signed certificate:<a class="headerlink" href="#if-a-valid-ssl-certificate-is-not-already-created-for-the-server-create-a-self-signed-certificate" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span># OpenSSL configuration
OPENSSL_C=&#39;LU&#39;
OPENSSL_ST=&#39;State&#39;
OPENSSL_L=&#39;Location&#39;
OPENSSL_O=&#39;Organization&#39;
OPENSSL_OU=&#39;Organizational Unit&#39;
OPENSSL_CN=&#39;Common Name&#39;
OPENSSL_EMAILADDRESS=&#39;info@localhost&#39;
</pre></div>

<div class="codehilite"><pre><span></span>sudo openssl req -newkey rsa:4096 -days <span class="m">3650</span> -nodes -x509 -subj <span class="s2">&quot;/C=</span><span class="nv">$OPENSSL_C</span><span class="s2">/ST=</span><span class="nv">$OPENSSL_ST</span><span class="s2">/L=</span><span class="nv">$OPENSSL_L</span><span class="s2">/O=&lt;</span><span class="nv">$OPENSSL_O</span><span class="s2">/OU=</span><span class="nv">$OPENSSL_OU</span><span class="s2">/CN=</span><span class="nv">$OPENSSL_CN</span><span class="s2">/emailAddress=</span><span class="nv">$OPENSSL_EMAILADDRESS</span><span class="s2">&quot;</span> -keyout /etc/openssl/private/server.key -out /usr/pkg/etc/httpd/server.crt
</pre></div>

<h4 id="install-python-virtualenv">Install Python virtualenv<a class="headerlink" href="#install-python-virtualenv" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo ln -sf /usr/pkg/bin/pip3.6 /usr/pkg/bin/pip
sudo ln -s /usr/pkg/bin/python3.6 /usr/pkg/bin/python
sudo ln -s /usr/pkg/bin/python3.6 /usr/pkg/bin/python3
sudo pkgin install py36-virtualenv
sudo ln -s /usr/pkg/bin/virtualenv-3.6 /usr/pkg/bin/virtualenv
</pre></div>

<h4 id="install-ssdeep">Install ssdeep<a class="headerlink" href="#install-ssdeep" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo mkdir -p /usr/local/src
sudo chown misp:users /usr/local/src
cd /usr/local/src
git clone https://github.com/ssdeep-project/ssdeep.git
cd ssdeep
./bootstrap
./configure --prefix=/usr
make
sudo make install
</pre></div>

<h4 id="usrpkgetcphpini">/usr/pkg/etc/php.ini<a class="headerlink" href="#usrpkgetcphpini" title="Permanent link">&para;</a></h4>
<h4 id="enable-redis">Enable redis<a class="headerlink" href="#enable-redis" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo cp /usr/pkg/share/examples/rc.d/redis /etc/rc.d
<span class="nb">echo</span> <span class="nv">redis</span><span class="o">=</span>yes <span class="p">|</span>sudo tee /etc/rc.conf.d/redis
sudo /etc/rc.d/redis start
</pre></div>

<h4 id="enable-mysqld">Enable mysqld<a class="headerlink" href="#enable-mysqld" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo /usr/pkg/bin/mysql_install_db
sudo cp /usr/pkg/share/examples/rc.d/mysqld /etc/rc.d/
<span class="nb">echo</span> <span class="nv">mysqld</span><span class="o">=</span>yes <span class="p">|</span>sudo tee /etc/rc.conf.d/mysqld
sudo chown -R mariadb:mariadb /var/mariadb
sudo /etc/rc.d/mysqld start
sudo /usr/pkg/bin/mysql_secure_installation
<span class="c1"># TODO: Figure out how to properly bind to localhost</span>
<span class="c1">##doas rcctl set mysqld flags --bind-address=127.0.0.1</span>
</pre></div>

<h3 id="2-misp-code">2/ MISP code<a class="headerlink" href="#2-misp-code" title="Permanent link">&para;</a></h3>
<hr />
<div class="codehilite"><pre><span></span><span class="c1"># Download MISP using git in the /usr/local/www/ directory.</span>
<span class="nv">PATH_TO_MISP</span><span class="o">=</span>/usr/pkg/share/httpd/htdocs/MISP
sudo mkdir <span class="nv">$PATH_TO_MISP</span>
sudo chown www:www <span class="nv">$PATH_TO_MISP</span>
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>
sudo -u www git clone https://github.com/MISP/MISP.git <span class="nv">$PATH_TO_MISP</span>
sudo -u www git submodule update --init --recursive
<span class="c1"># Make git ignore filesystem permission differences for submodules</span>
sudo -u www git submodule foreach --recursive git config core.filemode <span class="nb">false</span>

<span class="c1"># Make git ignore filesystem permission differences</span>
sudo -u www git config core.filemode <span class="nb">false</span>

<span class="c1">#sudo pkgin install py-pip py3-pip libxslt py3-jsonschema</span>
sudo pkgin install libxslt
<span class="c1">#sudo virtualenv -ppython3 /usr/local/virtualenvs/MISP</span>
sudo -u www virtualenv -ppython3 <span class="nv">$PATH_TO_MISP</span>/venv
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install -U pip

<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app/files/scripts
sudo -u www git clone https://github.com/CybOXProject/python-cybox.git
sudo -u www git clone https://github.com/STIXProject/python-stix.git
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app/files/scripts/python-cybox
sudo -u www <span class="nv">$PATH_TO_MISP</span>/venv/bin/python setup.py install --global-option<span class="o">=</span>build_ext --global-option<span class="o">=</span><span class="s2">&quot;-I/usr/pkg/include/&quot;</span>
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app/files/scripts/python-stix
sudo -u www <span class="nv">$PATH_TO_MISP</span>/venv/bin/python setup.py install

<span class="c1"># install mixbox to accommodate the new STIX dependencies:</span>
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app/files/scripts/
sudo -u www git clone https://github.com/CybOXProject/mixbox.git
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app/files/scripts/mixbox
sudo -u www <span class="nv">$PATH_TO_MISP</span>/venv/bin/python setup.py install

<span class="c1"># install PyMISP</span>
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/PyMISP
sudo -u www <span class="nv">$PATH_TO_MISP</span>/venv/bin/python setup.py install

<span class="c1"># install support for STIX 2.0</span>
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install stix2

<span class="c1"># install python-magic, pydeep and maec</span>
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install python-magic
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install git+https://github.com/kbandla/pydeep.git
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install maec
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install plyara
</pre></div>

<h3 id="3-cakephp">3/ CakePHP<a class="headerlink" href="#3-cakephp" title="Permanent link">&para;</a></h3>
<hr />
<div class="codehilite"><pre><span></span><span class="c1"># CakePHP is included as a submodule of MISP and has been fetched earlier.</span>
<span class="c1"># Install CakeResque along with its dependencies if you intend to use the built in background jobs:</span>
<span class="nb">cd</span> <span class="nv">$PATH_TO_MISP</span>/app
sudo -u www php -r <span class="s2">&quot;copy(&#39;https://getcomposer.org/installer&#39;, &#39;composer-setup.php&#39;);&quot;</span>
sudo -u www php -r <span class="s2">&quot;if (hash_file(&#39;SHA384&#39;, &#39;composer-setup.php&#39;) === &#39;a5c698ffe4b8e849a443b120cd5ba38043260d5c4023dbf93e1558871f1f07f58274fc6f4c93bcfd858c6bd0775cd8d1&#39;) { echo &#39;Installer verified&#39;; } else { echo &#39;Installer corrupt&#39;; unlink</span>
<span class="s2">(&#39;composer-setup.php&#39;); } echo PHP_EOL;&quot;</span>
sudo -u www env <span class="nv">HOME</span><span class="o">=</span>/tmp php composer-setup.php
sudo -u www php -r <span class="s2">&quot;unlink(&#39;composer-setup.php&#39;);&quot;</span>

sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp php composer.phar require kamisama/cake-resque:4.1.2
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp php composer.phar config vendor-dir Vendor
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp php composer.phar install

<span class="c1"># To use the scheduler worker for scheduled tasks, do the following:</span>
sudo -u www cp -f <span class="nv">$PATH_TO_MISP</span>/INSTALL/setup/config.php <span class="nv">$PATH_TO_MISP</span>/app/Plugin/CakeResque/Config/config.php
</pre></div>

<h3 id="4-set-the-permissions">4/ Set the permissions<a class="headerlink" href="#4-set-the-permissions" title="Permanent link">&para;</a></h3>
<hr />
<div class="codehilite"><pre><span></span><span class="c1"># Check if the permissions are set correctly using the following commands:</span>
sudo chown -R www:www <span class="nv">$PATH_TO_MISP</span>
sudo chmod -R <span class="m">750</span> <span class="nv">$PATH_TO_MISP</span>
sudo chmod -R g+ws <span class="nv">$PATH_TO_MISP</span>/app/tmp
sudo chmod -R g+ws <span class="nv">$PATH_TO_MISP</span>/app/files
sudo chmod -R g+ws <span class="nv">$PATH_TO_MISP</span>/app/files/scripts/tmp
</pre></div>

<h3 id="5-create-a-database-and-user">5/ Create a database and user<a class="headerlink" href="#5-create-a-database-and-user" title="Permanent link">&para;</a></h3>
<hr />
<div class="codehilite"><pre><span></span><span class="c1"># Enter the mysql shell</span>
sudo mysql -u root -p
</pre></div>

<div class="codehilite"><pre><span></span>MariaDB [(none)]&gt; create database misp;
MariaDB [(none)]&gt; grant usage on *.* to misp@localhost identified by &#39;XXXXdbpasswordhereXXXXX&#39;;
MariaDB [(none)]&gt; grant all privileges on misp.* to misp@localhost;
MariaDB [(none)]&gt; flush privileges;
MariaDB [(none)]&gt; exit
</pre></div>

<div class="codehilite"><pre><span></span><span class="c1"># Import the empty MISP database from MYSQL.sql</span>
sudo -u www sh -c <span class="s2">&quot;mysql -u misp -pmisp &lt; /var/www/htdocs/MISP/INSTALL/MYSQL.sql&quot;</span>
<span class="c1"># enter the password you set previously</span>
</pre></div>

<h3 id="6-apache-configuration">6/ Apache configuration<a class="headerlink" href="#6-apache-configuration" title="Permanent link">&para;</a></h3>
<hr />
<div class="codehilite"><pre><span></span><span class="c1"># Now configure your Apache webserver with the DocumentRoot /var/www/htdocs/MISP/app/webroot/</span>

<span class="c1">#2.4</span>
sudo /usr/pkg/etc/httpd/sites-available /usr/pkg/etc/httpd/sites-enabled

<span class="c1"># If the apache version is 2.4:</span>
sudo cp <span class="nv">$PATH_TO_MISP</span>/INSTALL/apache.24.misp.ssl /usr/pkg/etc/httpd/sites-available/misp-ssl.conf

<span class="c1"># Be aware that the configuration files for apache 2.4 and up have changed.</span>
<span class="c1"># The configuration file has to have the .conf extension in the sites-available directory</span>
<span class="c1"># For more information, visit http://httpd.apache.org/docs/2.4/upgrading.html</span>

<span class="c1"># If a valid SSL certificate is not already created for the server, create a self-signed certificate: (Make sure to fill the &lt;â€¦&gt;)</span>

sudo openssl req -newkey rsa:4096 -days <span class="m">3650</span> -nodes -x509 <span class="se">\</span>
-subj <span class="s2">&quot;/C=</span><span class="nv">$OPENSSL_C</span><span class="s2">/ST=</span><span class="nv">$OPENSSL_ST</span><span class="s2">/L=</span><span class="nv">$OPENSSL_L</span><span class="s2">/O=&lt;</span><span class="nv">$OPENSSL_O</span><span class="s2">/OU=</span><span class="nv">$OPENSSL_OU</span><span class="s2">/CN=</span><span class="nv">$OPENSSL_CN</span><span class="s2">/emailAddress=</span><span class="nv">$OPENSSL_EMAILADDRESS</span><span class="s2">&quot;</span> <span class="se">\</span>
-keyout /etc/ssl/private/server.key -out /etc/openssl/server.crt
<span class="c1"># Otherwise, copy the SSLCertificateFile, SSLCertificateKeyFile, and SSLCertificateChainFile to /etc/openssl/private/. (Modify path and config to fit your environment)</span>
</pre></div>

<div class="codehilite"><pre><span></span>============================================= Begin sample working SSL config for MISP
&lt;VirtualHost &lt;IP, FQDN, or *&gt;:80&gt;
        ServerName &lt;your.FQDN.here&gt;

        Redirect permanent / https://&lt;your.FQDN.here&gt;

        LogLevel warn
        ErrorLog /var/log/apache2/misp.local_error.log
        CustomLog /var/log/apache2/misp.local_access.log combined
        ServerSignature Off
&lt;/VirtualHost&gt;

&lt;VirtualHost &lt;IP, FQDN, or *&gt;:443&gt;
        ServerAdmin admin@&lt;your.FQDN.here&gt;
        ServerName &lt;your.FQDN.here&gt;
        DocumentRoot /var/www/htdocs/MISP/app/webroot
        &lt;Directory /var/www/htdocs/MISP/app/webroot&gt;
                Options -Indexes
                AllowOverride all
                Order allow,deny
                allow from all
        &lt;/Directory&gt;

        SSLEngine On
        SSLCertificateFile /etc/ssl/server.crt
        SSLCertificateKeyFile /etc/ssl/private/server.key
#        SSLCertificateChainFile /etc/ssl/private/misp-chain.crt

        LogLevel warn
        ErrorLog /var/log/apache2/misp.local_error.log
        CustomLog /var/log/apache2/misp.local_access.log combined
        ServerSignature Off
&lt;/VirtualHost&gt;
============================================= End sample working SSL config for MISP
</pre></div>

<div class="codehilite"><pre><span></span><span class="c1"># activate new vhost</span>
<span class="nb">cd</span> /etc/apache2/sites-enabled/
doas ln -s ../sites-available/misp-ssl.conf
<span class="nb">echo</span> <span class="s2">&quot;Include /etc/apache2/sites-enabled/*.conf&quot;</span> <span class="p">|</span>doas tee -a /etc/apache2/httpd2.conf

doas vi /etc/apache2/httpd2.conf
</pre></div>

<div class="codehilite"><pre><span></span>/!\ Enable mod_rewrite in httpd2.conf /!\
LoadModule rewrite_module /usr/local/lib/apache2/mod_rewrite.so
LoadModule ssl_module /usr/local/lib/apache2/mod_ssl.so
LoadModule proxy_module /usr/local/lib/apache2/mod_proxy.so
LoadModule proxy_fcgi_module /usr/local/lib/apache2/mod_proxy_fcgi.so
Listen 443
DirectoryIndex index.php

# Disable mpm_event, enable mpm_prefork
/usr/pkg/etc/httpd/httpd.conf
LoadModule php7_module lib/httpd/mod_php7.so
SetHandler application/x-httpd-php
AddType application/x-httpd-php .php
DirectoryIndex index.html index.php
/usr/pkg/share/httpd/htdocs
</pre></div>

<div class="codehilite"><pre><span></span>doas ln -sf /var/www/conf/modules.sample/php-7.0.conf /var/www/conf/modules/php.conf
<span class="c1"># Restart apache</span>
doas /etc/rc.d/apache2 restart
</pre></div>

<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>MISP saves the stdout and stderr of its workers in /var/www/htdocs/MISP/app/tmp/logs</p>
</div>
<h3 id="8-misp-configuration">8/ MISP configuration<a class="headerlink" href="#8-misp-configuration" title="Permanent link">&para;</a></h3>
<hr />
<p><div class="codehilite"><pre><span></span># There are 4 sample configuration files in $PATH_TO_MISP/app/Config that need to be copied
sudo -u www cp $PATH_TO_MISP/app/Config/bootstrap.default.php $PATH_TO_MISP/app/Config/bootstrap.php
sudo -u www cp $PATH_TO_MISP/app/Config/database.default.php $PATH_TO_MISP/app/Config/database.php
sudo -u www cp $PATH_TO_MISP/app/Config/core.default.php $PATH_TO_MISP/app/Config/core.php
sudo -u www cp $PATH_TO_MISP/app/Config/config.default.php $PATH_TO_MISP/app/Config/config.php

# Configure the fields in the newly created files:
sudo -u www vi $PATH_TO_MISP/app/Config/database.php
</pre></div>
<div class="codehilite"><pre><span></span># DATABASE_CONFIG has to be filled
# With the default values provided in section 6, this would look like:
# class DATABASE_CONFIG {
#   public $default = array(
#       &#39;datasource&#39; =&gt; &#39;Database/Mysql&#39;,
#       &#39;persistent&#39; =&gt; false,
#       &#39;host&#39; =&gt; &#39;localhost&#39;,
#       &#39;login&#39; =&gt; &#39;misp&#39;, // grant usage on *.* to misp@localhost
#       &#39;port&#39; =&gt; 3306,
#       &#39;password&#39; =&gt; &#39;XXXXdbpasswordhereXXXXX&#39;, // identified by &#39;XXXXdbpasswordhereXXXXX&#39;;
#       &#39;database&#39; =&gt; &#39;misp&#39;, // create database misp;
#       &#39;prefix&#39; =&gt; &#39;&#39;,
#       &#39;encoding&#39; =&gt; &#39;utf8&#39;,
#   );
#}
</pre></div></p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Important! Change the salt key in /usr/local/www/MISP/app/Config/config.php
The salt key must be a string at least 32 bytes long.
The admin user account will be generated on the first login, make sure that the salt is changed before you create that user
If you forget to do this step, and you are still dealing with a fresh installation, just alter the salt,
delete the user from mysql and log in again using the default admin credentials (<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;">&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;</a> / admin)</p>
</div>
<div class="codehilite"><pre><span></span># Change base url in config.php
sudo -u www vi $PATH_TO_MISP/app/Config/config.php
# example: &#39;baseurl&#39; =&gt; &#39;https://&lt;your.FQDN.here&gt;&#39;,
# alternatively, you can leave this field empty if you would like to use relative pathing in MISP
# &#39;baseurl&#39; =&gt; &#39;&#39;,

# and make sure the file permissions are still OK
sudo chown -R www:www $PATH_TO_MISP/app/Config
sudo chmod -R 750 $PATH_TO_MISP/app/Config

# Generate a GPG encryption key.
export GPG_REAL_NAME=&#39;Autogenerated Key&#39;
export GPG_COMMENT=&#39;WARNING: MISP AutoGenerated Key consider this Key VOID!&#39;
export GPG_EMAIL_ADDRESS=&#39;admin@admin.test&#39;
export GPG_KEY_LENGTH=&#39;2048&#39;
export GPG_PASSPHRASE=&#39;Password1234&#39;
echo &quot;%echo Generating a default key
    Key-Type: default
    Key-Length: $GPG_KEY_LENGTH
    Subkey-Type: default
    Name-Real: $GPG_REAL_NAME
    Name-Comment: $GPG_COMMENT
    Name-Email: $GPG_EMAIL_ADDRESS
    Expire-Date: 0
    Passphrase: $GPG_PASSPHRASE
    # Do a commit here, so that we can later print &quot;done&quot;
    %commit
%echo done&quot; &gt; /tmp/gen-key-script
sudo -u www mkdir $PATH_TO_MISP/.gnupg
sudo chmod 700 $PATH_TO_MISP/.gnupg
sudo gpg2 --homedir $PATH_TO_MISP/.gnupg --batch --gen-key /tmp/gen-key-script
# The email address should match the one set in the config.php / set in the configuration menu in the administration menu configuration file

# And export the public key to the webroot
sudo sh -c &quot;gpg2 --homedir $PATH_TO_MISP/.gnupg --export --armor $GPG_EMAIL_ADDRESS &gt; $PATH_TO_MISP/app/webroot/gpg.asc&quot;

# To make the background workers start on boot
sudo chmod +x $PATH_TO_MISP/app/Console/worker/start.sh
sudo vi /etc/rc.local
# Add the following line before the last line (exit 0). Make sure that you replace www with your apache user:
sudo -u www bash $PATH_TO_MISP/app/Console/worker/start.sh
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have installed the recommended Python 3 virtualenv to the recommended place of <strong>${PATH_TO_MISP}/venv</strong> set the following MISP configurable
<div class="codehilite"><pre><span></span>sudo -H -u www-data <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.python_bin&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span><span class="s2">/venv/bin/python&quot;</span>
</pre></div>
or on CentOS
<div class="codehilite"><pre><span></span>sudo -u apache <span class="nv">$RUN_PHP</span> <span class="s2">&quot;</span><span class="nv">$CAKE</span><span class="s2"> Admin setSetting &quot;</span>MISP.python_bin<span class="s2">&quot; &quot;</span><span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/venv/bin/python<span class="s2">&quot;&quot;</span>
</pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the STIX libraries and GnuPG work as intended, if not, refer to the relevant sections in the install guide you are currently reading.</p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Now log in using the webinterface: http://misp/users/login<br />
The default user/pass = <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;">&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;</a>/admin<br />
Using the server settings tool in the admin interface (Administration -&gt; Server Settings), set MISP up to your preference.<br />
It is especially vital that no critical issues remain!<br />
Don't forget to change the email, password and authentication key after installation.<br />
Once done, have a look at the diagnostics.</p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If any of the directories that MISP uses to store files is not writeable to the apache user, change the permissions<br />
you can do this by running the following commands:
<div class="codehilite"><pre><span></span>chmod -R <span class="m">750</span> <span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/&lt;directory path with an indicated issue&gt;
<span class="c1"># /!\ Depending on your OS replace www-data with apache or www or whatever user is the web server user.</span>
chown -R www-data:www-data <span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/&lt;directory path with an indicated issue&gt;
</pre></div></p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If anything goes wrong, make sure that you check MISP's logs for errors:
<div class="codehilite"><pre><span></span># ${PATH_TO_MISP}/app/tmp/logs/error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-worker-error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-scheduler-error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-2018-10-25.log //where the actual date is the current date
</pre></div></p>
</div>
<h3 id="recommended-actions">Recommended actions<a class="headerlink" href="#recommended-actions" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li>
<p>By default CakePHP exposes its name and version in email headers. Apply a patch to remove this behavior.</p>
</li>
<li>
<p>You should really harden your OS</p>
</li>
<li>You should really harden the configuration of Apache</li>
<li>You should really harden the configuration of MySQL</li>
<li>Keep your software up2date (MISP, CakePHP and everything else)</li>
<li>Log and audit</li>
</ul>
<h4 id="misp-modules">MISP Modules<a class="headerlink" href="#misp-modules" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>#/usr/pkgsrc/graphics/opencv2/ (needs X11)
sudo pkgin install jpeg yara
cd /usr/local/src/
git clone https://github.com/MISP/misp-modules.git
cd misp-modules
# pip3 install
sudo $PATH_TO_MISP/venv/bin/pip install -I -r REQUIREMENTS
sudo $PATH_TO_MISP/venv/bin/pip install -I .
sudo $PATH_TO_MISP/venv/bin/pip install git+https://github.com/VirusTotal/yara-python.git
sudo $PATH_TO_MISP/venv/bin/pip install wand
##doas gem install pygments.rb
##doas gem install asciidoctor-pdf --pre
sudo -u www $PATH_TO_MISP/venv/bin/misp-modules -l 0.0.0.0 -s &amp;
echo &quot;sudo -u www $PATH_TO_MISP/venv/bin/misp-modules -l 0.0.0.0 -s &amp;&quot; |doas tee -a /etc/rc.local
</pre></div>

<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Make sure that the STIX libraries and GnuPG work as intended, if not, refer to INSTALL.txt's paragraphs dealing with these two items</p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If anything goes wrong, make sure that you check MISP's logs for errors:
/var/www/htdocs/MISP/app/tmp/logs/error.log
/var/www/htdocs/MISP/app/tmp/logs/resque-worker-error.log
/var/www/htdocs/MISP/app/tmp/logs/resque-scheduler-error.log
/var/www/htdocs/MISP/app/tmp/logs/resque-2015-01-01.log // where the actual date is the current date</p>
</div>
<h4 id="misp-config-automation">MISP Config Automation<a class="headerlink" href="#misp-config-automation" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo -u www <span class="nv">$CAKE</span> Live <span class="nv">$MISP_LIVE</span>
<span class="nv">AUTH_KEY</span><span class="o">=</span><span class="k">$(</span>mysql -u misp -p misp -e <span class="s2">&quot;SELECT authkey FROM users;&quot;</span> <span class="p">|</span> tail -1<span class="k">)</span>
<span class="c1"># Update the galaxiesâ€¦</span>
sudo -u www <span class="nv">$CAKE</span> Admin updateGalaxies

<span class="c1"># Updating the taxonomiesâ€¦</span>
sudo -u www <span class="nv">$CAKE</span> Admin updateTaxonomies

<span class="c1"># Updating the warning listsâ€¦</span>
sudo -u www <span class="nv">$CAKE</span> Admin updateWarningLists

<span class="c1"># Updating the notice listsâ€¦</span>
sudo -u www <span class="nv">$CAKE</span> Admin updateNoticeLists

<span class="c1"># Updating the object templatesâ€¦</span>
sudo -u www <span class="nv">$CAKE</span> Admin updateObjectTemplates <span class="m">1337</span>

<span class="c1"># Tune global time outs</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.autoRegenerate&quot;</span> <span class="m">0</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.timeout&quot;</span> <span class="m">600</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.cookie_timeout&quot;</span> <span class="m">3600</span>

<span class="c1"># Enable GnuPG</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;GnuPG.email&quot;</span> <span class="s2">&quot;admin@admin.test&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;GnuPG.homedir&quot;</span> <span class="s2">&quot;</span><span class="nv">$PATH_TO_MISP</span><span class="s2">/.gnupg&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;GnuPG.password&quot;</span> <span class="s2">&quot;Password1234&quot;</span>

<span class="c1"># Enable Enrichment set better timeouts</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_services_enable&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_hover_enable&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_timeout&quot;</span> <span class="m">300</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_hover_timeout&quot;</span> <span class="m">150</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_cve_enabled&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_dns_enabled&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_services_url&quot;</span> <span class="s2">&quot;http://127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Enrichment_services_port&quot;</span> <span class="m">6666</span>

<span class="c1"># Enable Import modules set better timout</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_services_enable&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_services_url&quot;</span> <span class="s2">&quot;http://127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_services_port&quot;</span> <span class="m">6666</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_timeout&quot;</span> <span class="m">300</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_ocr_enabled&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Import_csvimport_enabled&quot;</span> <span class="nb">true</span>

<span class="c1"># Enable Export modules set better timout</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Export_services_enable&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Export_services_url&quot;</span> <span class="s2">&quot;http://127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Export_services_port&quot;</span> <span class="m">6666</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Export_timeout&quot;</span> <span class="m">300</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Export_pdfexport_enabled&quot;</span> <span class="nb">true</span>

<span class="c1"># Enable installer org and tune some configurables</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.host_org_id&quot;</span> <span class="m">1</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.email&quot;</span> <span class="s2">&quot;info@admin.test&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.disable_emailing&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.contact&quot;</span> <span class="s2">&quot;info@admin.test&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.disablerestalert&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.showCorrelationsOnIndex&quot;</span> <span class="nb">true</span>

<span class="c1"># Provisional Cortex tunes</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_enable&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_url&quot;</span> <span class="s2">&quot;http://127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_port&quot;</span> <span class="m">9000</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_timeout&quot;</span> <span class="m">120</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_url&quot;</span> <span class="s2">&quot;http://127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_port&quot;</span> <span class="m">9000</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_timeout&quot;</span> <span class="m">120</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_services_authkey&quot;</span> <span class="s2">&quot;&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_ssl_verify_peer&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_ssl_verify_host&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Cortex_ssl_allow_self_signed&quot;</span> <span class="nb">true</span>

<span class="c1"># Various plugin sightings settings</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Sightings_policy&quot;</span> <span class="m">0</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Sightings_anonymise&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.Sightings_range&quot;</span> <span class="m">365</span>

<span class="c1"># Plugin CustomAuth tuneable</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.CustomAuth_disable_logout&quot;</span> <span class="nb">false</span>

<span class="c1"># RPZ Plugin settings</span>

sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_policy&quot;</span> <span class="s2">&quot;DROP&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_walled_garden&quot;</span> <span class="s2">&quot;127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_serial&quot;</span> <span class="s2">&quot;\$date00&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_refresh&quot;</span> <span class="s2">&quot;2h&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_retry&quot;</span> <span class="s2">&quot;30m&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_expiry&quot;</span> <span class="s2">&quot;30d&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_minimum_ttl&quot;</span> <span class="s2">&quot;1h&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_ttl&quot;</span> <span class="s2">&quot;1w&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_ns&quot;</span> <span class="s2">&quot;localhost.&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_ns_alt&quot;</span> <span class="s2">&quot;&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Plugin.RPZ_email&quot;</span> <span class="s2">&quot;root.localhost&quot;</span>

<span class="c1"># Force defaults to make MISP Server Settings less RED</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.language&quot;</span> <span class="s2">&quot;eng&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.proposals_block_attributes&quot;</span> <span class="nb">false</span>

<span class="c1">## Redis block</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.redis_host&quot;</span> <span class="s2">&quot;127.0.0.1&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.redis_port&quot;</span> <span class="m">6379</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.redis_database&quot;</span> <span class="m">13</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.redis_password&quot;</span> <span class="s2">&quot;&quot;</span>

<span class="c1"># Force defaults to make MISP Server Settings less YELLOW</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.ssdeep_correlation_threshold&quot;</span> <span class="m">40</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.extended_alert_subject&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.default_event_threat_level&quot;</span> <span class="m">4</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.newUserText&quot;</span> <span class="s2">&quot;Dear new MISP user,\\n\\nWe would hereby like to welcome you to the \$org MISP community.\\n\\n Use the credentials below to log into MISP at \$misp, where you will be prompted to manually change your password to something of your own choice.\\n\\nUsername: \$username\\nPassword: \$password\\n\\nIf you have any questions, don&#39;t hesitate to contact us at: \$contact.\\n\\nBest regards,\\nYour \$org MISP support team&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.passwordResetText&quot;</span> <span class="s2">&quot;Dear MISP user,\\n\\nA password reset has been triggered for your account. Use the below provided temporary password to log into MISP at \$misp, where you will be prompted to manually change your password to something of your own choice.\\n\\nUsername: \$username\\nYour temporary password: \$password\\n\\nIf you have any questions, don&#39;t hesitate to contact us at: \$contact.\\n\\nBest regards,\\nYour \$org MISP support team&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.enableEventBlacklisting&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.enableOrgBlacklisting&quot;</span> <span class="nb">true</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.log_client_ip&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.log_auth&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.disableUserSelfManagement&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.block_event_alert&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.block_event_alert_tag&quot;</span> <span class="s2">&quot;no-alerts=\&quot;true\&quot;&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.block_old_event_alert&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.block_old_event_alert_age&quot;</span> <span class="s2">&quot;&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.incoming_tags_disabled_by_default&quot;</span> <span class="nb">false</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.footermidleft&quot;</span> <span class="s2">&quot;This is an initial install&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.footermidright&quot;</span> <span class="s2">&quot;Please configure and harden accordingly&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.welcome_text_top&quot;</span> <span class="s2">&quot;Initial Install, please configure&quot;</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.welcome_text_bottom&quot;</span> <span class="s2">&quot;Welcome to MISP, change this message in MISP Settings&quot;</span>

<span class="c1"># Force defaults to make MISP Server Settings less GREEN</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Security.password_policy_length&quot;</span> <span class="m">12</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Security.password_policy_complexity&quot;</span> <span class="s1">&#39;/^((?=.*\d)|(?=.*\W+))(?![\n])(?=.*[A-Z])(?=.*[a-z]).*$|.{16,}/&#39;</span>
<span class="c1"># Tune global time outs</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.autoRegenerate&quot;</span> <span class="m">0</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.timeout&quot;</span> <span class="m">600</span>
sudo -u www <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;Session.cookie_timeout&quot;</span> <span class="m">3600</span>
</pre></div>

<h3 id="recommended-actions_1">Recommended actions<a class="headerlink" href="#recommended-actions_1" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li>
<p>By default CakePHP exposes its name and version in email headers. Apply a patch to remove this behavior.</p>
</li>
<li>
<p>You should really harden your OS</p>
</li>
<li>You should really harden the configuration of Apache/httpd</li>
<li>You should really harden the configuration of MySQL/MariaDB</li>
<li>Keep your software up2date (OS, MISP, CakePHP and everything else)</li>
<li>Log and audit</li>
</ul>
<h3 id="optional-features">Optional features<a class="headerlink" href="#optional-features" title="Permanent link">&para;</a></h3>
<hr />
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>MISP has a pub/sub feature, using ZeroMQ.</p>
</div>
<h4 id="zeromq-depends-on-the-python-client-for-redis">ZeroMQ depends on the Python client for Redis<a class="headerlink" href="#zeromq-depends-on-the-python-client-for-redis" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pkgin install zeromq
sudo -u www <span class="nv">HOME</span><span class="o">=</span>/tmp <span class="nv">$PATH_TO_MISP</span>/venv/bin/pip install pyzmq
</pre></div>

<h4 id="misp-dashboard">misp-dashboard<a class="headerlink" href="#misp-dashboard" title="Permanent link">&para;</a></h4>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Enable ZeroMQ for misp-dashboard</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This still needs more testing, it runs but no data is showing.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The install_dependencies.sh script is for Linux ONLY. The following blurp will be a diff of a working OpenBSD version.</p>
</div>
<div class="codehilite"><pre><span></span>(DASHENV) obsd# diff -u install_dependencies.sh install_dependencies_obsd.sh  
<span class="gd">--- install_dependencies.sh     Fri Oct 19 12:14:38 2018</span>
<span class="gi">+++ install_dependencies_obsd.sh        Fri Oct 19 12:43:22 2018</span>
<span class="gu">@@ -1,14 +1,14 @@</span>
<span class="gd">-#!/bin/bash</span>
<span class="gi">+#!/usr/local/bin/bash</span>

 set -e
 #set -x

<span class="gd">-sudo apt-get install python3-virtualenv virtualenv screen redis-server unzip -y</span>
<span class="gi">+doas pkg_add -v unzip wget</span>

 if [ -z &quot;$VIRTUAL_ENV&quot; ]; then
<span class="gd">-    virtualenv -p python3 DASHENV</span>
<span class="gi">+    virtualenv -p python3 /usr/local/virtualenvs/DASHENV</span>

<span class="gd">-    . ./DASHENV/bin/activate</span>
<span class="gi">+    . /usr/local/virtualenvs/DASHENV/bin/activate</span>
 fi

 pip3 install -U pip argparse redis zmq geoip2 flask phonenumbers pycountry
</pre></div>

<div class="codehilite"><pre><span></span>cd /var/www
doas mkdir misp-dashboard
doas chown www:www misp-dashboard
doas -u www git clone https://github.com/MISP/misp-dashboard.git
cd misp-dashboard
#/!\ Made on Linux, the next script will fail
#doas /var/www/misp-dashboard/install_dependencies.sh
doas virtualenv -ppython3 /usr/local/virtualenvs/DASHENV
doas /usr/local/virtualenvs/DASHENV/bin/pip install -U pip argparse redis zmq geoip2 flask phonenumbers pycountry

doas sed -i &quot;s/^host\ =\ localhost/host\ =\ 0.0.0.0/g&quot; /var/www/misp-dashboard/config/config.cfg
doas sed -i -e &#39;$i \doas -u www bash /var/www/misp-dashboard/start_all.sh\n&#39; /etc/rc.local
#/!\ Add port 8001 as a listener
#doas sed -i &#39;/Listen 80/a Listen 0.0.0.0:8001&#39; /etc/apache2/ports.conf
doas pkg_add -v ap2-mod_wsgi

echo &quot;&lt;VirtualHost *:8001&gt;
    ServerAdmin admin@misp.local
    ServerName misp.local
    DocumentRoot /var/www/misp-dashboard

    WSGIDaemonProcess misp-dashboard \
       user=misp group=misp \
       python-home=/var/www/misp-dashboard/DASHENV \
       processes=1 \
       threads=15 \
       maximum-requests=5000 \
       listen-backlog=100 \
       queue-timeout=45 \
       socket-timeout=60 \
       connect-timeout=15 \
       request-timeout=60 \
       inactivity-timeout=0 \
       deadlock-timeout=60 \
       graceful-timeout=15 \
       eviction-timeout=0 \
       shutdown-timeout=5 \
       send-buffer-size=0 \
       receive-buffer-size=0 \
       header-buffer-size=0 \
       response-buffer-size=0 \
       server-metrics=Off
    WSGIScriptAlias / /var/www/misp-dashboard/misp-dashboard.wsgi
    &lt;Directory /var/www/misp-dashboard&gt;
        WSGIProcessGroup misp-dashboard
        WSGIApplicationGroup %{GLOBAL}
        Require all granted
    &lt;/Directory&gt;
    LogLevel info
    ErrorLog /var/log/apache2/misp-dashboard.local_error.log
    CustomLog /var/log/apache2/misp-dashboard.local_access.log combined
    ServerSignature Off
&lt;/VirtualHost&gt;&quot; | doas tee /etc/apache2/sites-available/misp-dashboard.conf

doas ln -s /etc/apache2/sites-available/misp-dashboard.conf /etc/apache2/sites-enabled/misp-dashboard.conf
</pre></div>

<p>Add this to /etc/httpd2.conf
<div class="codehilite"><pre><span></span>LoadModule wsgi_module /usr/local/lib/apache2/mod_wsgi.so
Listen 8001
</pre></div></p>
<div class="codehilite"><pre><span></span>sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_event_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_object_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_object_reference_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_attribute_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_sighting_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_user_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_organisation_notifications_enable&quot; true
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_port&quot; 50000
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_redis_host&quot; &quot;localhost&quot;
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_redis_port&quot; 6379
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_redis_database&quot; 1
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_redis_namespace&quot; &quot;mispq&quot;
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_include_attachments&quot; false
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_tag_notifications_enable&quot; false
sudo -u www $CAKE Admin setSetting &quot;Plugin.ZeroMQ_audit_notifications_enable&quot; false
</pre></div>

<h1 id="hardening-a-base-system">Hardening a base system<a class="headerlink" href="#hardening-a-base-system" title="Permanent link">&para;</a></h1>
<h2 id="intro">Intro<a class="headerlink" href="#intro" title="Permanent link">&para;</a></h2>
<p>MISP is a web-based <strong>information sharing platform</strong>, by design it is kept rather simple and hardening can be done by following the common best practices.</p>
<p>Bare in mind that neither the MISP documentation efforts or the core MISP project can give you the ultimate guide on how to harden your system.
This is not the purpose of the MISP Project but the purpose and care of those individuals and organizations deploying MISP Instances.</p>
<p>Nevertheless here is a very rough <strong>food for thoughts</strong> bulletpoint list for you to consider, and a list of some hardening ressources below.</p>
<ul>
<li>Are we using SSL by default? (Especially when syncing over the internet and exposing the API)</li>
<li>How to we access the machine remotely? Via ssh? What is the path to get there? Does a <a href="https://en.wikipedia.org/wiki/Bastion_host">bastion host</a> make sense?</li>
<li>Is the machine shared with other user accounts? Do I need to care about useri-land security due to this sharing?</li>
<li>Is the instance deployed in the "<strong>cloud</strong>"? Is it a VPS? AWS? docker? ansible? kubernetes? whateverCloudContainterMagicIsFancibleNow?</li>
<li>Do we need to encrypt the partitions where some data is stored?</li>
<li>Are we redundant in case one MISP instance might fail?</li>
<li>Is the database server and any other servers running on the machine bound to <strong>localhost</strong>? Do we need to expose because our setup is more complex?</li>
<li>Do we have enough storage? What about <a href="https://misp-project.org/MISP-sizer/">MISP and size estimation</a> anyways?</li>
<li>Do we care about BIOS updates?</li>
<li>Do we care about physical access to the servers? (Disabling USB ports etc...)</li>
<li>Is any fancy management engine Ã  la <a href="https://en.wikipedia.org/wiki/Intel_Management_Engine">IME</a> in use?</li>
</ul>
<h2 id="apache">Apache<a class="headerlink" href="#apache" title="Permanent link">&para;</a></h2>
<p>To make Apache less verbose in terms of sending banners, the belo might help.</p>
<div class="codehilite"><pre><span></span>diff --git a/apache2/conf-available/security.conf b/apache2/conf-available/security.conf
index f9f69d4..2e8fd78 100644
--- a/apache2/conf-available/security.conf
+++ b/apache2/conf-available/security.conf
@@ -22,7 +22,7 @@
 # Set to one of:  Full | OS | Minimal | Minor | Major | Prod
 # where Full conveys the most information, and Prod the least.
 #ServerTokens Minimal
-ServerTokens OS
+ServerTokens Prod
 #ServerTokens Full

 #
@@ -33,7 +33,7 @@ ServerTokens OS
 # Set to &quot;EMail&quot; to also include a mailto: link to the ServerAdmin.
 # Set to one of:  On | Off | EMail
 #ServerSignature Off
-ServerSignature On
+ServerSignature Off

 #
 # Allow TRACE method
</pre></div>

<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<p><a href="https://www.ncsc.nl/english/current-topics/factsheets/it-security-guidelines-for-transport-layer-security-tls.html">IT Security Guidelines for TLS by NCSC.nl</a></p>
<p><a href="https://weakdh.org/sysadmin.html">Weak Diffie-Hellman and the Logjam Attack</a></p>
<p><a href="https://wiki.debian.org/Hardening">Debian Wiki Hardening</a></p>
<p><a href="https://wiki.centos.org/HowTos/OS_Protection">CentOS Hardening</a></p>
<p><a href="https://www.cyberciti.biz/tips/linux-security.html">Some Linux hardening tips</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 MISP Project
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://www.misp-project.org/" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/MISP" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/MISPProject" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>